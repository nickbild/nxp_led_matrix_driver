/*
 * Nick Bild
 * NXP MIMXRT1010-EVK RGB LED Matrix Driver
 * For 32x32 RGB LED Matrices that are drop-in compatible
 * with https://www.adafruit.com/product/1484.
 *
 * Github repository:
 * https://github.com/nickbild/nxp_led_matrix_driver
 *
 * Project initialized with NXP's "led_blinky" demo app code.
 */

#include "board.h"
#include "pin_mux.h"
#include "cr_section_macros.h"

/*******************************************************************************
 * Definitions
 ******************************************************************************/

// GPIO pin mappings.							// Header, Pin Number
#define pinR1 BOARD_USER_AD1_GPIO_PIN			// J56, 14
#define pinG1 BOARD_USER_AD2_GPIO_PIN			// J56, 16
#define pinB1 BOARD_USER_AD3_GPIO_PIN			// J57, 10
#define pinR2 BOARD_USER_AD4_GPIO_PIN			// J57, 8
#define pinG2 BOARD_USER_AD5_GPIO_PIN			// J57, 6
#define pinB2 BOARD_USER_AD6_GPIO_PIN			// J57, 12
#define pinOE BOARD_USER_AD7_GPIO_PIN			// J26, 2
#define latch BOARD_USER_AD9_GPIO_PIN			// J26, 4
#define pinClk BOARD_USER_AD10_GPIO_PIN			// J26, 6
#define selectA BOARD_USER_AD14_GPIO_PIN		// J26, 8
#define selectB BOARD_USER_2_GPIO_PIN			// J57, 20
#define selectC BOARD_USER_9_GPIO_PIN			// J56, 2
#define selectD BOARD_USER_10_GPIO_PIN			// J56, 4

// PWM pattern restarts after this many frames are drawn.
// Higher == greater color resolution == more colors; too high == flicker.
#define totalFrames 40

#define bitRead(value, bit) (((value) >> (bit)) & 0x01)
#define STORE_IN_ITC_RAM(func) __attribute__((section(".ramfunc.$SRAM_ITC"))) func

/*******************************************************************************
 * Data to Display - Paste graphics data BELOW this comment.
 ******************************************************************************/

#define numImages 2  // >1 means animation.
#define changeImageFrames 6000  // Animation control. Set to -1 to display a single image.  Larger number == longer delay between image changes.

__RODATA(Flash2) const unsigned short int brightnessR[numImages][32][32] = {{{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {38, 38, 38, 0, 0, 0, 0, 0, 0, 38, 38, 31, 31, 10, 0, 0, 0, 0, 0, 10, 20, 20, 26, 26, 26, 26, 26, 26, 26, 0, 0, 0}, {38, 38, 38, 38, 0, 0, 0, 0, 0, 38, 38, 38, 31, 10, 0, 0, 0, 0, 0, 10, 20, 26, 26, 26, 26, 26, 26, 26, 26, 26, 0, 0}, {38, 38, 38, 38, 38, 0, 0, 0, 0, 38, 38, 38, 31, 10, 10, 0, 0, 0, 10, 10, 20, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 0}, {38, 38, 38, 38, 38, 38, 0, 0, 0, 38, 38, 38, 31, 10, 10, 10, 0, 10, 10, 10, 20, 26, 26, 0, 0, 0, 0, 0, 26, 26, 26, 26}, {38, 38, 38, 38, 38, 38, 38, 0, 0, 38, 38, 38, 31, 31, 10, 10, 10, 10, 10, 20, 20, 26, 26, 0, 0, 0, 0, 0, 26, 26, 26, 26}, {38, 38, 38, 0, 38, 38, 38, 38, 0, 38, 38, 38, 38, 31, 31, 10, 10, 10, 20, 20, 26, 26, 26, 0, 0, 0, 0, 0, 26, 26, 26, 26}, {38, 38, 38, 0, 0, 38, 38, 38, 38, 38, 38, 38, 38, 31, 31, 10, 10, 10, 20, 20, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 0}, {38, 38, 38, 0, 0, 0, 38, 38, 38, 38, 38, 38, 38, 31, 10, 10, 10, 10, 10, 20, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 0, 0}, {38, 38, 38, 0, 0, 0, 0, 38, 38, 38, 38, 38, 31, 31, 10, 10, 0, 10, 10, 20, 20, 26, 26, 26, 26, 26, 26, 26, 26, 0, 0, 0}, {38, 38, 38, 0, 0, 0, 0, 0, 38, 38, 38, 38, 31, 10, 10, 0, 0, 0, 10, 10, 20, 26, 26, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {38, 38, 38, 0, 0, 0, 0, 0, 0, 38, 38, 38, 31, 10, 0, 0, 0, 0, 0, 10, 20, 26, 26, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {38, 38, 38, 0, 0, 0, 0, 0, 0, 38, 38, 31, 31, 10, 0, 0, 0, 0, 0, 10, 20, 20, 26, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {35, 0, 0, 0, 0, 0, 35, 0, 0, 35, 35, 0, 0, 35, 35, 35, 35, 35, 0, 35, 35, 0, 0, 0, 35, 0, 35, 0, 0, 0, 35, 0}, {35, 35, 0, 0, 0, 35, 35, 0, 35, 0, 0, 35, 0, 0, 0, 35, 0, 0, 0, 35, 0, 35, 0, 0, 35, 0, 0, 35, 0, 35, 0, 0}, {35, 0, 35, 0, 35, 0, 35, 0, 35, 0, 0, 35, 0, 0, 0, 35, 0, 0, 0, 35, 0, 0, 35, 0, 35, 0, 0, 0, 35, 0, 0, 0}, {35, 0, 0, 35, 0, 0, 35, 0, 35, 35, 35, 35, 0, 0, 0, 35, 0, 0, 0, 35, 0, 35, 0, 0, 35, 0, 0, 0, 35, 0, 0, 0}, {35, 0, 0, 0, 0, 0, 35, 0, 35, 0, 0, 35, 0, 0, 0, 35, 0, 0, 0, 35, 35, 0, 0, 0, 35, 0, 0, 0, 35, 0, 0, 0}, {35, 0, 0, 0, 0, 0, 35, 0, 35, 0, 0, 35, 0, 0, 0, 35, 0, 0, 0, 35, 0, 35, 0, 0, 35, 0, 0, 35, 0, 35, 0, 0}, {35, 0, 0, 0, 0, 0, 35, 0, 35, 0, 0, 35, 0, 0, 0, 35, 0, 0, 0, 35, 0, 0, 35, 0, 35, 0, 35, 0, 0, 0, 35, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}}, {{20, 20, 20, 21, 20, 20, 21, 21, 20, 22, 21, 21, 21, 19, 18, 17, 17, 18, 19, 20, 20, 19, 19, 19, 19, 20, 20, 20, 20, 19, 19, 20}, {20, 20, 20, 21, 21, 21, 21, 21, 21, 22, 20, 17, 15, 13, 12, 12, 12, 11, 10, 12, 15, 18, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20}, {22, 21, 22, 22, 22, 22, 22, 22, 22, 18, 13, 16, 17, 14, 12, 11, 10, 8, 8, 10, 10, 9, 14, 20, 20, 20, 21, 20, 20, 20, 20, 20}, {22, 22, 22, 23, 22, 22, 22, 22, 17, 15, 17, 19, 19, 16, 15, 14, 12, 10, 8, 6, 7, 9, 7, 9, 19, 21, 21, 21, 21, 21, 20, 20}, {23, 23, 23, 23, 22, 22, 22, 17, 16, 18, 18, 21, 19, 17, 16, 14, 12, 11, 9, 7, 6, 5, 6, 6, 8, 20, 22, 22, 22, 21, 20, 20}, {23, 23, 23, 23, 23, 24, 19, 15, 19, 22, 26, 28, 27, 25, 22, 20, 15, 12, 10, 8, 7, 5, 5, 6, 4, 9, 21, 22, 21, 21, 21, 22}, {23, 24, 24, 24, 23, 22, 15, 22, 28, 31, 32, 33, 32, 31, 28, 26, 22, 16, 12, 9, 7, 5, 5, 5, 4, 4, 14, 22, 22, 21, 22, 22}, {25, 25, 24, 24, 23, 17, 18, 28, 32, 34, 36, 35, 36, 34, 32, 30, 25, 20, 15, 11, 8, 6, 5, 5, 4, 4, 4, 19, 22, 22, 22, 22}, {24, 24, 24, 24, 20, 11, 23, 30, 35, 35, 35, 36, 36, 35, 33, 31, 28, 23, 18, 13, 10, 7, 5, 5, 4, 4, 4, 13, 22, 22, 22, 22}, {24, 24, 24, 23, 16, 12, 24, 31, 35, 35, 35, 36, 36, 35, 34, 31, 28, 24, 20, 16, 11, 8, 8, 5, 4, 4, 4, 5, 21, 22, 21, 21}, {25, 25, 25, 21, 15, 13, 25, 31, 33, 35, 34, 34, 34, 34, 32, 30, 28, 25, 23, 19, 15, 10, 6, 5, 4, 3, 3, 3, 16, 17, 20, 20}, {26, 26, 24, 18, 12, 16, 26, 31, 34, 34, 34, 34, 33, 33, 32, 30, 29, 27, 26, 23, 19, 11, 7, 6, 5, 4, 3, 3, 10, 16, 19, 18}, {27, 27, 22, 15, 10, 17, 28, 31, 32, 34, 34, 34, 33, 33, 32, 31, 30, 29, 28, 25, 20, 12, 6, 5, 4, 4, 4, 3, 8, 14, 15, 16}, {29, 27, 20, 13, 11, 17, 28, 30, 30, 32, 33, 34, 33, 28, 27, 27, 28, 27, 25, 22, 18, 12, 7, 5, 4, 4, 5, 4, 6, 14, 11, 15}, {27, 24, 17, 13, 11, 15, 25, 24, 23, 24, 31, 32, 27, 19, 21, 25, 22, 18, 17, 17, 17, 12, 7, 6, 5, 4, 4, 4, 5, 11, 11, 12}, {25, 22, 14, 13, 12, 14, 17, 23, 21, 21, 28, 31, 22, 19, 25, 22, 17, 17, 14, 19, 21, 15, 8, 7, 6, 4, 4, 4, 5, 11, 11, 11}, {22, 22, 16, 12, 10, 18, 25, 29, 26, 25, 30, 32, 21, 24, 31, 30, 25, 24, 27, 28, 25, 16, 8, 7, 6, 5, 5, 5, 5, 10, 10, 10}, {17, 20, 15, 12, 9, 21, 31, 30, 28, 30, 31, 32, 24, 26, 31, 30, 30, 30, 31, 29, 24, 15, 7, 6, 6, 5, 4, 5, 5, 9, 9, 10}, {13, 17, 15, 10, 8, 21, 31, 33, 33, 33, 32, 32, 26, 29, 34, 35, 35, 34, 31, 27, 21, 12, 6, 5, 6, 4, 5, 5, 6, 8, 11, 10}, {12, 14, 14, 12, 10, 17, 30, 33, 34, 33, 33, 31, 26, 29, 33, 34, 35, 32, 29, 24, 19, 11, 7, 7, 7, 6, 6, 5, 6, 10, 16, 15}, {11, 11, 12, 12, 11, 13, 29, 33, 33, 31, 33, 31, 26, 27, 32, 32, 33, 31, 26, 21, 16, 9, 7, 6, 7, 6, 5, 4, 5, 6, 10, 10}, {10, 9, 11, 12, 9, 9, 25, 31, 32, 29, 33, 29, 24, 23, 33, 33, 31, 28, 23, 20, 15, 9, 7, 7, 6, 7, 4, 5, 5, 7, 8, 10}, {10, 10, 10, 10, 9, 8, 20, 28, 30, 32, 27, 19, 14, 19, 31, 31, 28, 25, 22, 18, 14, 9, 7, 5, 6, 5, 6, 4, 5, 7, 7, 9}, {10, 9, 9, 9, 9, 9, 17, 25, 28, 32, 32, 22, 21, 25, 26, 26, 27, 25, 21, 18, 14, 9, 6, 7, 7, 6, 6, 5, 5, 7, 9, 10}, {11, 10, 10, 11, 12, 9, 14, 26, 27, 26, 27, 25, 21, 20, 21, 27, 28, 25, 21, 18, 13, 9, 6, 6, 7, 5, 5, 5, 5, 7, 8, 10}, {11, 11, 11, 12, 10, 9, 9, 22, 28, 32, 31, 29, 26, 24, 26, 27, 27, 23, 20, 16, 12, 8, 7, 6, 7, 7, 5, 4, 6, 7, 8, 10}, {13, 12, 11, 10, 9, 9, 8, 11, 22, 29, 30, 27, 25, 25, 24, 24, 23, 20, 16, 14, 11, 8, 6, 6, 6, 5, 5, 3, 5, 7, 10, 12}, {15, 14, 13, 10, 9, 9, 10, 8, 11, 24, 32, 34, 32, 28, 25, 23, 20, 16, 15, 13, 10, 7, 6, 7, 6, 6, 5, 4, 6, 7, 9, 12}, {14, 13, 12, 10, 11, 11, 11, 8, 8, 12, 26, 30, 28, 25, 21, 17, 15, 14, 13, 11, 9, 7, 7, 6, 6, 7, 6, 5, 6, 6, 8, 11}, {17, 15, 10, 12, 9, 9, 8, 6, 7, 7, 12, 18, 18, 17, 15, 14, 14, 12, 10, 10, 10, 9, 7, 7, 6, 6, 5, 4, 5, 5, 6, 9}, {17, 16, 11, 9, 9, 9, 8, 7, 6, 7, 8, 9, 13, 12, 12, 12, 10, 10, 11, 12, 11, 11, 10, 7, 7, 5, 5, 4, 5, 5, 4, 8}, {16, 16, 12, 11, 9, 9, 8, 8, 7, 8, 8, 9, 20, 18, 15, 14, 13, 13, 14, 14, 15, 15, 13, 9, 7, 6, 6, 5, 6, 5, 6, 8}}};

__RODATA(Flash2) const unsigned short int brightnessG[numImages][32][32] = {{{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {27, 27, 27, 0, 0, 0, 0, 0, 0, 27, 27, 24, 24, 26, 0, 0, 0, 0, 0, 26, 29, 29, 37, 37, 37, 37, 37, 37, 37, 0, 0, 0}, {27, 27, 27, 27, 0, 0, 0, 0, 0, 27, 27, 27, 24, 26, 0, 0, 0, 0, 0, 26, 29, 37, 37, 37, 37, 37, 37, 37, 37, 37, 0, 0}, {27, 27, 27, 27, 27, 0, 0, 0, 0, 27, 27, 27, 24, 26, 26, 0, 0, 0, 26, 26, 29, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 0}, {27, 27, 27, 27, 27, 27, 0, 0, 0, 27, 27, 27, 24, 26, 26, 26, 0, 26, 26, 26, 29, 37, 37, 0, 0, 0, 0, 0, 37, 37, 37, 37}, {27, 27, 27, 27, 27, 27, 27, 0, 0, 27, 27, 27, 24, 24, 26, 26, 26, 26, 26, 29, 29, 37, 37, 0, 0, 0, 0, 0, 37, 37, 37, 37}, {27, 27, 27, 0, 27, 27, 27, 27, 0, 27, 27, 27, 27, 24, 24, 26, 26, 26, 29, 29, 37, 37, 37, 0, 0, 0, 0, 0, 37, 37, 37, 37}, {27, 27, 27, 0, 0, 27, 27, 27, 27, 27, 27, 27, 27, 24, 24, 26, 26, 26, 29, 29, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 0}, {27, 27, 27, 0, 0, 0, 27, 27, 27, 27, 27, 27, 27, 24, 26, 26, 26, 26, 26, 29, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 0, 0}, {27, 27, 27, 0, 0, 0, 0, 27, 27, 27, 27, 27, 24, 24, 26, 26, 0, 26, 26, 29, 29, 37, 37, 37, 37, 37, 37, 37, 37, 0, 0, 0}, {27, 27, 27, 0, 0, 0, 0, 0, 27, 27, 27, 27, 24, 26, 26, 0, 0, 0, 26, 26, 29, 37, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {27, 27, 27, 0, 0, 0, 0, 0, 0, 27, 27, 27, 24, 26, 0, 0, 0, 0, 0, 26, 29, 37, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {27, 27, 27, 0, 0, 0, 0, 0, 0, 27, 27, 24, 24, 26, 0, 0, 0, 0, 0, 26, 29, 29, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {39, 0, 0, 0, 0, 0, 39, 0, 0, 39, 39, 0, 0, 39, 39, 39, 39, 39, 0, 39, 39, 0, 0, 0, 39, 0, 39, 0, 0, 0, 39, 0}, {39, 39, 0, 0, 0, 39, 39, 0, 39, 0, 0, 39, 0, 0, 0, 39, 0, 0, 0, 39, 0, 39, 0, 0, 39, 0, 0, 39, 0, 39, 0, 0}, {39, 0, 39, 0, 39, 0, 39, 0, 39, 0, 0, 39, 0, 0, 0, 39, 0, 0, 0, 39, 0, 0, 39, 0, 39, 0, 0, 0, 39, 0, 0, 0}, {39, 0, 0, 39, 0, 0, 39, 0, 39, 39, 39, 39, 0, 0, 0, 39, 0, 0, 0, 39, 0, 39, 0, 0, 39, 0, 0, 0, 39, 0, 0, 0}, {39, 0, 0, 0, 0, 0, 39, 0, 39, 0, 0, 39, 0, 0, 0, 39, 0, 0, 0, 39, 39, 0, 0, 0, 39, 0, 0, 0, 39, 0, 0, 0}, {39, 0, 0, 0, 0, 0, 39, 0, 39, 0, 0, 39, 0, 0, 0, 39, 0, 0, 0, 39, 0, 39, 0, 0, 39, 0, 0, 39, 0, 39, 0, 0}, {39, 0, 0, 0, 0, 0, 39, 0, 39, 0, 0, 39, 0, 0, 0, 39, 0, 0, 0, 39, 0, 0, 39, 0, 39, 0, 39, 0, 0, 0, 39, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}}, {{21, 22, 21, 22, 21, 21, 22, 21, 20, 22, 21, 21, 21, 18, 17, 15, 16, 17, 19, 20, 20, 20, 20, 20, 21, 21, 21, 22, 22, 20, 20, 20}, {21, 21, 21, 21, 22, 21, 21, 22, 21, 22, 19, 14, 9, 7, 7, 7, 7, 6, 5, 8, 13, 18, 20, 21, 22, 21, 22, 22, 22, 21, 21, 20}, {23, 22, 23, 22, 22, 22, 22, 22, 21, 14, 8, 10, 11, 8, 7, 6, 6, 5, 5, 5, 5, 5, 12, 19, 21, 21, 22, 22, 21, 21, 21, 21}, {23, 23, 23, 23, 23, 23, 23, 21, 13, 10, 11, 13, 12, 10, 9, 9, 7, 6, 5, 3, 4, 5, 3, 7, 18, 21, 22, 23, 22, 22, 22, 21}, {23, 24, 23, 23, 23, 23, 22, 13, 11, 12, 12, 15, 13, 11, 10, 9, 7, 6, 5, 4, 3, 3, 3, 3, 6, 19, 22, 23, 23, 23, 22, 22}, {23, 24, 24, 24, 24, 24, 16, 10, 13, 17, 20, 22, 21, 19, 17, 13, 9, 7, 6, 4, 4, 2, 3, 3, 2, 7, 21, 23, 22, 23, 22, 23}, {24, 24, 24, 25, 24, 21, 10, 17, 22, 25, 26, 27, 26, 25, 22, 20, 15, 10, 7, 5, 4, 3, 3, 2, 2, 2, 13, 23, 23, 23, 24, 24}, {25, 25, 25, 25, 23, 14, 12, 22, 26, 28, 30, 29, 29, 28, 26, 24, 19, 14, 10, 6, 4, 3, 2, 2, 2, 2, 2, 19, 24, 24, 24, 23}, {24, 25, 25, 25, 19, 7, 17, 25, 29, 29, 29, 30, 29, 28, 27, 25, 22, 17, 12, 8, 5, 4, 2, 2, 2, 2, 2, 12, 23, 23, 23, 23}, {24, 25, 25, 23, 12, 7, 18, 25, 28, 29, 29, 29, 30, 28, 27, 25, 22, 18, 14, 10, 7, 4, 4, 2, 2, 2, 2, 3, 21, 23, 22, 22}, {25, 26, 25, 19, 11, 8, 19, 24, 27, 28, 27, 28, 28, 28, 26, 23, 21, 19, 17, 13, 9, 5, 3, 2, 2, 1, 1, 2, 16, 20, 21, 22}, {26, 27, 23, 14, 6, 11, 20, 25, 27, 28, 28, 27, 27, 27, 26, 23, 23, 21, 20, 17, 13, 6, 3, 3, 2, 2, 1, 1, 10, 17, 19, 19}, {27, 26, 20, 10, 5, 11, 22, 25, 26, 27, 28, 28, 27, 27, 25, 25, 24, 22, 22, 19, 14, 7, 3, 2, 2, 2, 2, 1, 7, 16, 15, 17}, {28, 27, 18, 8, 6, 12, 22, 24, 24, 25, 27, 27, 26, 21, 20, 21, 21, 21, 19, 16, 13, 7, 4, 3, 2, 2, 3, 2, 4, 15, 13, 16}, {26, 25, 14, 9, 6, 10, 19, 17, 17, 17, 24, 25, 19, 12, 14, 18, 15, 12, 11, 11, 11, 7, 4, 3, 2, 2, 2, 2, 3, 12, 13, 15}, {25, 23, 12, 8, 7, 9, 11, 17, 14, 15, 21, 25, 15, 13, 18, 16, 11, 11, 9, 13, 15, 9, 4, 4, 3, 2, 2, 2, 3, 12, 12, 13}, {23, 22, 13, 6, 5, 13, 19, 22, 20, 18, 23, 26, 15, 18, 24, 22, 19, 17, 20, 22, 18, 10, 4, 3, 3, 2, 3, 3, 3, 11, 12, 12}, {18, 20, 11, 5, 4, 15, 24, 24, 21, 23, 24, 25, 17, 20, 24, 23, 23, 24, 24, 22, 17, 9, 4, 4, 3, 2, 2, 3, 3, 9, 11, 12}, {14, 16, 12, 4, 3, 14, 24, 27, 27, 27, 25, 26, 20, 22, 27, 28, 28, 27, 24, 20, 15, 7, 3, 3, 3, 2, 3, 3, 4, 9, 13, 12}, {13, 12, 10, 6, 4, 11, 23, 26, 27, 26, 27, 25, 20, 22, 26, 27, 28, 25, 22, 17, 12, 6, 3, 4, 5, 4, 4, 3, 4, 10, 17, 16}, {11, 9, 7, 5, 5, 7, 22, 26, 26, 24, 27, 25, 20, 20, 25, 25, 25, 24, 19, 15, 10, 5, 4, 3, 4, 3, 4, 3, 4, 6, 11, 12}, {9, 7, 5, 5, 3, 5, 17, 24, 25, 22, 26, 22, 17, 17, 26, 25, 24, 21, 17, 13, 9, 5, 3, 4, 4, 3, 3, 4, 3, 5, 8, 11}, {10, 8, 6, 4, 4, 3, 13, 20, 23, 26, 20, 12, 8, 12, 24, 24, 22, 19, 15, 12, 8, 5, 4, 3, 4, 3, 5, 3, 4, 6, 7, 9}, {10, 7, 6, 4, 3, 4, 10, 18, 20, 25, 25, 16, 14, 18, 20, 19, 21, 18, 15, 12, 9, 5, 3, 3, 4, 4, 4, 4, 4, 5, 9, 11}, {10, 8, 6, 6, 5, 4, 8, 18, 20, 19, 20, 17, 14, 13, 14, 20, 22, 19, 15, 12, 8, 4, 3, 3, 4, 3, 3, 3, 4, 5, 8, 11}, {12, 10, 7, 6, 3, 4, 4, 15, 21, 25, 24, 21, 18, 16, 19, 21, 20, 17, 13, 10, 7, 4, 4, 3, 4, 4, 3, 2, 3, 5, 7, 11}, {12, 10, 7, 4, 3, 4, 4, 6, 15, 22, 23, 20, 19, 19, 17, 18, 17, 14, 10, 9, 6, 4, 4, 4, 4, 3, 3, 2, 4, 5, 7, 13}, {15, 12, 9, 5, 3, 3, 4, 4, 6, 17, 26, 27, 25, 21, 18, 16, 13, 10, 9, 7, 5, 4, 3, 4, 4, 4, 3, 2, 4, 6, 7, 13}, {14, 12, 8, 6, 4, 4, 5, 4, 4, 7, 19, 23, 21, 18, 14, 11, 9, 8, 8, 6, 5, 4, 4, 3, 3, 4, 3, 3, 4, 4, 5, 12}, {17, 15, 7, 6, 3, 3, 3, 2, 3, 4, 7, 12, 12, 11, 10, 8, 8, 7, 5, 6, 7, 5, 4, 4, 3, 4, 3, 2, 5, 4, 5, 11}, {18, 17, 8, 5, 3, 4, 3, 3, 3, 3, 5, 5, 8, 7, 7, 7, 7, 6, 7, 7, 7, 7, 6, 4, 4, 3, 4, 3, 4, 4, 4, 9}, {17, 17, 11, 7, 5, 4, 3, 4, 3, 4, 5, 6, 14, 12, 11, 9, 8, 8, 9, 9, 11, 10, 8, 4, 4, 3, 4, 3, 3, 3, 4, 10}}};

__RODATA(Flash2) const unsigned short int brightnessB[numImages][32][32] = {{{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {8, 8, 8, 0, 0, 0, 0, 0, 0, 8, 8, 12, 12, 39, 0, 0, 0, 0, 0, 39, 11, 11, 14, 14, 14, 14, 14, 14, 14, 0, 0, 0}, {8, 8, 8, 8, 0, 0, 0, 0, 0, 8, 8, 8, 12, 39, 0, 0, 0, 0, 0, 39, 11, 14, 14, 14, 14, 14, 14, 14, 14, 14, 0, 0}, {8, 8, 8, 8, 8, 0, 0, 0, 0, 8, 8, 8, 12, 39, 39, 0, 0, 0, 39, 39, 11, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 0}, {8, 8, 8, 8, 8, 8, 0, 0, 0, 8, 8, 8, 12, 39, 39, 39, 0, 39, 39, 39, 11, 14, 14, 0, 0, 0, 0, 0, 14, 14, 14, 14}, {8, 8, 8, 8, 8, 8, 8, 0, 0, 8, 8, 8, 12, 12, 39, 39, 39, 39, 39, 11, 11, 14, 14, 0, 0, 0, 0, 0, 14, 14, 14, 14}, {8, 8, 8, 0, 8, 8, 8, 8, 0, 8, 8, 8, 8, 12, 12, 39, 39, 39, 11, 11, 14, 14, 14, 0, 0, 0, 0, 0, 14, 14, 14, 14}, {8, 8, 8, 0, 0, 8, 8, 8, 8, 8, 8, 8, 8, 12, 12, 39, 39, 39, 11, 11, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 0}, {8, 8, 8, 0, 0, 0, 8, 8, 8, 8, 8, 8, 8, 12, 39, 39, 39, 39, 39, 11, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 0, 0}, {8, 8, 8, 0, 0, 0, 0, 8, 8, 8, 8, 8, 12, 12, 39, 39, 0, 39, 39, 11, 11, 14, 14, 14, 14, 14, 14, 14, 14, 0, 0, 0}, {8, 8, 8, 0, 0, 0, 0, 0, 8, 8, 8, 8, 12, 39, 39, 0, 0, 0, 39, 39, 11, 14, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {8, 8, 8, 0, 0, 0, 0, 0, 0, 8, 8, 8, 12, 39, 0, 0, 0, 0, 0, 39, 11, 14, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {8, 8, 8, 0, 0, 0, 0, 0, 0, 8, 8, 12, 12, 39, 0, 0, 0, 0, 0, 39, 11, 11, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 0, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}}, {{12, 12, 11, 12, 13, 12, 12, 12, 12, 13, 12, 13, 12, 11, 10, 9, 10, 11, 11, 12, 12, 13, 13, 12, 13, 13, 13, 13, 13, 12, 11, 11}, {13, 12, 12, 12, 13, 13, 13, 14, 12, 13, 10, 6, 4, 3, 4, 4, 4, 4, 4, 5, 7, 11, 12, 13, 14, 13, 14, 14, 15, 13, 13, 12}, {14, 13, 13, 13, 14, 13, 14, 14, 12, 6, 3, 4, 3, 4, 4, 4, 4, 4, 4, 3, 3, 3, 6, 10, 13, 14, 14, 14, 13, 12, 13, 13}, {15, 13, 14, 13, 15, 15, 14, 12, 7, 3, 4, 4, 4, 4, 4, 5, 4, 4, 4, 3, 3, 3, 2, 5, 10, 13, 14, 15, 15, 14, 14, 13}, {14, 14, 14, 14, 15, 15, 13, 6, 5, 4, 4, 5, 5, 4, 5, 5, 3, 4, 4, 3, 3, 3, 3, 3, 4, 11, 13, 14, 16, 15, 14, 14}, {15, 15, 16, 15, 16, 16, 10, 4, 6, 7, 9, 10, 9, 7, 6, 5, 4, 4, 4, 3, 4, 3, 4, 3, 3, 5, 12, 15, 15, 15, 15, 15}, {15, 15, 15, 17, 17, 14, 5, 7, 10, 13, 13, 13, 12, 11, 9, 7, 5, 4, 4, 4, 4, 4, 4, 3, 4, 3, 7, 14, 15, 16, 16, 16}, {15, 16, 17, 18, 17, 8, 5, 10, 14, 15, 16, 15, 15, 13, 11, 10, 7, 5, 4, 4, 3, 3, 3, 4, 4, 4, 3, 11, 15, 16, 16, 15}, {15, 16, 18, 18, 12, 4, 7, 11, 15, 16, 15, 15, 15, 14, 12, 11, 8, 5, 4, 4, 3, 3, 3, 4, 3, 4, 3, 7, 16, 15, 16, 16}, {16, 18, 19, 17, 7, 5, 7, 12, 15, 15, 14, 16, 15, 13, 12, 11, 8, 5, 5, 4, 4, 4, 3, 4, 4, 3, 3, 4, 14, 15, 14, 15}, {15, 17, 18, 12, 5, 4, 8, 12, 14, 14, 13, 14, 13, 14, 11, 10, 8, 7, 6, 5, 4, 4, 4, 3, 4, 3, 3, 3, 10, 14, 12, 14}, {16, 17, 14, 7, 5, 6, 9, 12, 14, 14, 13, 13, 14, 14, 12, 10, 10, 8, 8, 7, 6, 4, 4, 4, 4, 3, 4, 3, 7, 11, 10, 11}, {17, 17, 12, 6, 5, 6, 10, 14, 13, 15, 14, 14, 14, 13, 12, 12, 11, 10, 10, 8, 6, 4, 4, 4, 4, 4, 4, 4, 6, 10, 9, 10}, {18, 17, 10, 6, 6, 7, 11, 12, 11, 12, 13, 14, 13, 9, 8, 9, 9, 9, 8, 7, 6, 4, 5, 5, 5, 4, 4, 5, 5, 10, 8, 10}, {17, 17, 8, 6, 5, 7, 9, 8, 8, 7, 11, 11, 8, 6, 6, 7, 6, 6, 5, 5, 5, 4, 4, 5, 5, 5, 4, 4, 5, 9, 9, 9}, {17, 16, 8, 6, 6, 6, 7, 8, 7, 7, 9, 10, 7, 6, 8, 7, 5, 5, 5, 6, 7, 5, 5, 6, 5, 5, 5, 5, 5, 9, 9, 9}, {15, 15, 9, 5, 5, 7, 10, 11, 9, 8, 10, 12, 7, 8, 11, 9, 7, 8, 10, 10, 8, 5, 4, 5, 5, 5, 5, 5, 5, 8, 9, 8}, {12, 14, 7, 4, 4, 7, 12, 11, 9, 10, 10, 12, 7, 9, 10, 10, 10, 11, 11, 10, 7, 4, 4, 5, 5, 5, 5, 4, 5, 7, 7, 8}, {10, 10, 7, 4, 4, 6, 11, 14, 13, 13, 12, 12, 9, 10, 12, 15, 15, 13, 10, 8, 6, 4, 4, 5, 5, 5, 5, 4, 5, 7, 9, 7}, {9, 8, 7, 5, 4, 5, 10, 12, 14, 14, 14, 13, 10, 11, 12, 13, 14, 12, 9, 8, 5, 4, 4, 6, 6, 5, 6, 5, 5, 8, 12, 10}, {8, 7, 6, 4, 5, 4, 10, 13, 13, 12, 15, 13, 10, 10, 12, 12, 12, 11, 9, 7, 5, 3, 5, 4, 5, 5, 5, 5, 5, 5, 9, 8}, {7, 6, 5, 4, 4, 4, 8, 12, 12, 10, 14, 11, 9, 7, 13, 12, 12, 10, 7, 6, 5, 3, 4, 6, 5, 5, 5, 6, 5, 6, 7, 8}, {7, 7, 5, 5, 5, 3, 6, 10, 10, 11, 10, 6, 5, 6, 12, 11, 10, 9, 7, 6, 4, 4, 4, 4, 6, 5, 7, 5, 5, 6, 7, 7}, {7, 6, 6, 5, 4, 5, 5, 8, 9, 12, 12, 7, 7, 9, 10, 8, 10, 9, 7, 6, 5, 4, 4, 5, 5, 5, 5, 6, 5, 5, 7, 9}, {8, 6, 6, 5, 5, 5, 5, 9, 9, 8, 8, 7, 6, 6, 6, 9, 10, 9, 7, 6, 5, 4, 3, 5, 5, 5, 5, 6, 6, 6, 7, 8}, {8, 7, 6, 5, 4, 5, 5, 7, 10, 12, 11, 9, 8, 7, 9, 9, 10, 8, 6, 6, 4, 3, 5, 4, 5, 5, 5, 5, 5, 6, 6, 8}, {9, 7, 6, 5, 4, 5, 5, 5, 7, 10, 11, 9, 8, 9, 8, 8, 7, 7, 5, 5, 4, 4, 5, 5, 5, 5, 5, 4, 5, 6, 6, 9}, {10, 8, 7, 6, 4, 4, 4, 5, 4, 8, 13, 13, 12, 10, 8, 8, 6, 5, 5, 5, 3, 4, 4, 5, 5, 5, 4, 5, 6, 6, 5, 9}, {10, 8, 7, 5, 5, 4, 4, 4, 4, 5, 9, 10, 9, 8, 6, 5, 5, 4, 5, 5, 5, 4, 4, 4, 5, 5, 5, 5, 6, 5, 5, 9}, {12, 11, 6, 6, 4, 4, 4, 4, 4, 5, 6, 6, 6, 5, 5, 5, 5, 5, 4, 5, 5, 4, 3, 4, 4, 5, 5, 4, 6, 5, 5, 9}, {13, 12, 6, 5, 5, 4, 4, 4, 4, 4, 5, 4, 5, 5, 5, 6, 5, 4, 5, 5, 5, 4, 4, 3, 4, 4, 5, 4, 5, 5, 5, 8}, {12, 12, 8, 7, 5, 5, 4, 4, 4, 4, 5, 5, 6, 6, 6, 5, 5, 5, 5, 5, 6, 5, 4, 4, 5, 4, 5, 5, 4, 5, 5, 7}}};

/*******************************************************************************
 * END of Data to Display - Paste graphics data ABOVE this comment.
 ******************************************************************************/

/*******************************************************************************
 * Code
 ******************************************************************************/

STORE_IN_ITC_RAM(void matrix_draw(void));

void main(void) {
	BOARD_InitPins();
    matrix_draw();
}

void matrix_draw() {
	// Current state of matrix.
	unsigned short int currentRow = 0;
	unsigned short int currentRowBottom = 0;
	unsigned short int frame = 1;  // A "frame" is defined here as one draw of all rows on the matrix.

	// Animation control.
	unsigned short int imgNum = 0;
	int framesElapsed = 0;

	while(1) {
		currentRowBottom = currentRow + 16;

		// Send on/off bits for each LED (32 columns, R/G/B LED per column), and for top-half and bottom-half rows.
		for (unsigned short int i=0; i<32; i++) {
			// Upper rows.
			if (frame <= brightnessR[imgNum][currentRow][i]) {
				BOARD_USER_GPIO->DR |= (1UL << pinR1);
			} else {
				BOARD_USER_GPIO->DR &= ~(1UL << pinR1);
			}

			if (frame <= brightnessG[imgNum][currentRow][i]) {
				BOARD_USER_GPIO->DR |= (1UL << pinG1);
			} else {
				BOARD_USER_GPIO->DR &= ~(1UL << pinG1);
			}

			if (frame <= brightnessB[imgNum][currentRow][i]) {
				BOARD_USER_GPIO->DR |= (1UL << pinB1);
			} else {
				BOARD_USER_GPIO->DR &= ~(1UL << pinB1);
			}

			// Lower rows.
			if (frame <= brightnessR[imgNum][currentRowBottom][i]) {
				BOARD_USER_GPIO->DR |= (1UL << pinR2);
			} else {
				BOARD_USER_GPIO->DR &= ~(1UL << pinR2);
			}

			if (frame <= brightnessG[imgNum][currentRowBottom][i]) {
				BOARD_USER_GPIO->DR |= (1UL << pinG2);
			} else {
				BOARD_USER_GPIO->DR &= ~(1UL << pinG2);
			}

			if (frame <= brightnessB[imgNum][currentRowBottom][i]) {
				BOARD_USER_GPIO->DR |= (1UL << pinB2);
			} else {
				BOARD_USER_GPIO->DR &= ~(1UL << pinB2);
			}

			// Hit clock to indicate pixel values are set.
			BOARD_USER_GPIO->DR |= (1UL << pinClk);
			BOARD_USER_GPIO->DR &= ~(1UL << pinClk);
		}

		// Set current row.
		if (bitRead(currentRow, 0)) {
			BOARD_USER_GPIO->DR |= (1UL << selectA);
		} else {
			BOARD_USER_GPIO->DR &= ~(1UL << selectA);
		}

		if (bitRead(currentRow, 1)) {
			BOARD_USER_GPIO->DR |= (1UL << selectB);
		} else {
			BOARD_USER_GPIO->DR &= ~(1UL << selectB);
		}

		if (bitRead(currentRow, 2)) {
			BOARD_USER_GPIO->DR |= (1UL << selectC);
		} else {
			BOARD_USER_GPIO->DR &= ~(1UL << selectC);
		}

		if (bitRead(currentRow, 3)) {
			BOARD_USER_GPIO->DR |= (1UL << selectD);
		} else {
			BOARD_USER_GPIO->DR &= ~(1UL << selectD);
		}

		// Blank display.
		BOARD_USER_GPIO->DR |= (1UL << pinOE);

		// All data is in.  Latch current row.
		BOARD_USER_GPIO->DR |= (1UL << latch);
		BOARD_USER_GPIO->DR &= ~(1UL << latch);

		// Enable display.
		BOARD_USER_GPIO->DR &= ~(1UL << pinOE);

		// Move to next row.
		currentRow++;
		if (currentRow == 16) {
			currentRow = 0;

			frame++;
			if (frame > totalFrames) {
				frame = 1;
			}

			framesElapsed++;
		}

		// Control image change speed.
		if (framesElapsed >= changeImageFrames) {
			framesElapsed = 0;

			imgNum++;
			if (imgNum == numImages) {
				imgNum = 0;
			}
		}
	}
}
